{% extends 'base.html' %}

{% block title %}Home{% endblock %}

{% block content %}
    <h1>Welcome to Pixel Art App</h1>
    <p style="text-align: center;">Upload or draw pixel art for your ESP32!</p>
    
    <h2>Gallery</h2>
    <div class="gallery" id="gallery">
        <!-- Images will be loaded here via JS or server-side rendering if I updated the route -->
    </div>

    <script>
        fetch('{{ url_for("api_list_images") }}')
            .then(response => response.json())
            .then(data => {
                const gallery = document.getElementById('gallery');
                if (data.images.length === 0) {
                    gallery.innerHTML = '<p>No images found. <a href="{{ url_for("draw") }}">Draw one!</a></p>';
                } else {
                    data.images.forEach(img => {
                        const item = document.createElement('div');
                        item.className = 'gallery-item';
                        item.innerHTML = `
                            <a href="${img.url}" target="_blank">
                                <img src="${img.url}" alt="${img.filename}">
                            </a>
                            <br>
                            <small>${img.width}x${img.height}</small>
                        `;
                        gallery.appendChild(item);
                    });
                }
            })
            .catch(err => console.error('Error loading gallery:', err));
    </script>
{% endblock %}
